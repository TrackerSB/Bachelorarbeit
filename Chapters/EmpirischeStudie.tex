\chapter{Experiment Setup And Execution}
\section{Goals}

\section{Measurement Methology}
\draftnote{What is measured?
    \begin{itemize}
        \item ratio sequential and parallel instructions
        \item reasons for parents of SCoPs being invalid as SCoP
        \item Theoretical impact if certain reasons would not appear
    \end{itemize}
}
\subsection{Definition ratios}
Let \(SI_s\in\mathbb{N}\) be the number of instructions not within a \scop, \(PI_s\in\mathbb{N}\) the number of instructions within a \scop and \(AI\in\mathbb{N}\) the number of all instructions such that \(SI_s + PI_s = AI\).
Then the \scop ratio is defined as:
\[RS_{par} := \frac{PI_s}{AI}\]
Let \(SI_p\in\mathbb{N}\) be the number of instructions not within a parent of a \scop, \(PI_p\in\mathbb{N}\) the number of instructions within a parent of a \scop and \(AI\in\mathbb{N}\) the number of all instructions such that \(SI_p + PI_p = AI\).
Then the parent-of-\scop ratio is defined as:
\[RP_{par} := \frac{PI_p}{AI}\]
\subsection[Amdahl's Law]{Amdahl's Law \cite{AmdahlsLaw}}
Let \(N\in\mathbb{N}\) be the number of processors, \(RS_{par}\in\mathbb{Q}\) be the \scops ratio and \(RP_{par}\in\mathbb{Q}\) the parent-of-\scop ratio.
Then the speedups \(S_s, S_p\in\mathbb{Q}\) are defined as:
\[S_s := \frac{N}{(1-RS_{par})*N+RS_{par}}\]
\[S_p := \frac{N}{(1-RP_{par})*N+RP_{par}}\]
\subsection{Reasons for SCoPs being invalid}
These are the implemented criteria of Polly for rejecting a parent of a \scop being also a \scop.
\begin{itemize}
    \item Parent is toplevel (\autoref{lst:parentIsToplevel})
    \item Unsupported terminator instruction
    \item Unreachable in exit block (\autoref{lst:unreachableExitBlock})
    \item Irreducible loops (\autoref{lst:irreducibleLoops})
    \item Undefinded branch condition
    \item Non-integer branch condition
    \item Undefined operands in comparison
    \item Non-affine branch condition
    \item No base pointer
    \item Undefinded base pointer
    \item Variant base pointer (\autoref{lst:variantBasePointer})
    \item Non-affine memory accesses (\autoref{lst:nonAffineMemoryAccesses})
    \item Accesses with differing sizes
    \item Uncomputable loop bounds (\autoref{lst:uncomputeableLoopBounds})
    \item Loop without exit (\autoref{lst:loopWithoutExit})
    \item Function call with side effects (\autoref{lst:functionCallSideEffects})
    \item Complicated access semantics (volatile or atomic)
    \item Base address aliasing (\autoref{lst:baseAddressAliasing})
    \item Integer to pointer conversion (\autoref{lst:integerToPointer})
    \item Stack allocations
    \item Unknown instructions
    \item Contains entry block
    \item Assumed to be unprofitable (\autoref{lst:assumedUnprofitable})
\end{itemize}

\begin{comment}
    Following is copy\&pasted from pollys ScopDetectionDiagnostic.cpp

SCOP_STAT(CFG, ""),
SCOP_STAT(InvalidTerminator, "Unsupported terminator instruction"),
SCOP_STAT(UnreachableInExit, "Unreachable in exit block"),
SCOP_STAT(IrreducibleRegion, "Irreducible loops"),
SCOP_STAT(LastCFG, ""),
SCOP_STAT(AffFunc, ""),
SCOP_STAT(UndefCond, "Undefined branch condition"),
SCOP_STAT(InvalidCond, "Non-integer branch condition"),
SCOP_STAT(UndefOperand, "Undefined operands in comparison"),
SCOP_STAT(NonAffBranch, "Non-affine branch condition"),
SCOP_STAT(NoBasePtr, "No base pointer"),
SCOP_STAT(UndefBasePtr, "Undefined base pointer"),
SCOP_STAT(VariantBasePtr, "Variant base pointer"),
SCOP_STAT(NonAffineAccess, "Non-affine memory accesses"),
SCOP_STAT(DifferentElementSize, "Accesses with differing sizes"),
SCOP_STAT(LastAffFunc, ""),
SCOP_STAT(LoopBound, "Uncomputable loop bounds"),
SCOP_STAT(LoopHasNoExit, "Loop without exit"),
SCOP_STAT(FuncCall, "Function call with side effects"),
SCOP_STAT(NonSimpleMemoryAccess,
          "Compilated access semantics (volatile or atomic)"),
SCOP_STAT(Alias, "Base address aliasing"),
SCOP_STAT(Other, ""),
SCOP_STAT(IntToPtr, "Integer to pointer conversions"),
SCOP_STAT(Alloca, "Stack allocations"),
SCOP_STAT(UnknownInst, "Unknown Instructions"),
SCOP_STAT(Entry, "Contains entry block"),
SCOP_STAT(Unprofitable, "Assumed to be unprofitable"),
SCOP_STAT(LastOther, "")
\end{comment}

\section{Experiment Variables}
\begin{table}[H]
    \myfloatalign
    \begin{tabularx}{\textwidth}{Xccccc} \toprule
        \tableheadline{Name} & \tableheadline{Abbr.} & \tableheadline{Type} & \tableheadline{Scale Type} & \tableheadline{Unit} & \tableheadline{Range} \\ \midrule
        Ratio \scop & \(RS_{par}\) & ? & Ratio & \% & \([0, 100]\)\\
        Ratio parent-of-\scop & \(RP_{par}\) & ? & Ratio & \% & \([0, 100]\)\\
        Speedup \scop & \(S_s\) & ? & Ratio & ? & \(\mathbb{Q}\)\\
        Speedup parent-of-\scop & \(S_p\) & ? & Ratio & ? & \(\mathbb{Q}\)\\
        \bottomrule
    \end{tabularx}
    \caption{Experiment Variables}
\end{table}

\section{Hypotheses}

\section{Subject Programs}
\begin{table}[H]
    \myfloatalign
    \begin{tabularx}{\textwidth}{XcC} \toprule
        \tableheadline{Name} & \tableheadline{Version} & \tableheadline{Tested Inputs} \\ \midrule
        benchbuild & & ---\\
        llvm & & ---\\
        clang & & ---\\
        polly & & ---\\
        polli & & ---\\ \midrule
        7z & 9.38.1\\
        Rasdaman & \draftnote{git}\\
        bzip2 & 1.0.6\\
        ccrypt & 1.10 & Integrated tests\\
        crafty & 25.2 & Integrated benchmark\\
        crocopat & 2.1.4 & Integrated benchmark\\
        ffmpeg & 3.1.3\\
        gzip & 1.6\\
        js\\
        lammps & \draftnote{git} & Integrated sample problems\\
        lapack & & Integrated tests\\
        leveldb & \draftnote{git} & Integrated benchmark\\
        libressl & 2.1.6\\
        linpack & & Integrated benchmark\\
        lulesh & 1.0 & Integrated benchmark\\
        lulesh-omp & 1.0 & Integrated benchmark\\
        mcrypt & 2.6.8 & Integrated benchmark\\
        minisat & \draftnote{git}\\
        openblas & \draftnote{git}\\
        postgres & & Integrated benchmark\\
        povray & \draftnote{git} & Integrated sample scenes\\
        python & 3.4.3\\
        ruby & 2.2.2\\
        sqlite3 & \draftnote{3080900} & leveldb's integrated benchmark\\
        tcc & 0.9.26\\
        x264 & \draftnote{git} & Integrated benchmark\\
        xz & 5.2.1\\
        \bottomrule
    \end{tabularx}
    \caption[Subject programs]{Subject programs and benchbuild used. (Versions in parenthesis represent git hashes)}
\end{table}

\section{Tasks}
\draftnote{
    \begin{enumerate}
        \item Create Pass (\autoref{subsec:optimizer})
        \begin{itemize}
            \item How does the pass work?
        \end{itemize}
        \item Run benchbuild over the group \enquote{benchbuild}
        \item Analyse output
            \begin{itemize}
                \item Most common reasons for rejection?
                \item Ratio of SCoPs?
                \item Possible effect when theoretically solve reasons for rejection?
            \end{itemize}
    \end{enumerate}
}

\section{Design}

\section{Experiment Setting}

\section{Deviations}

\section{Analyse}
